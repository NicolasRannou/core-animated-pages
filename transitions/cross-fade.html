<!--
Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link href="core-pages-transition.html" rel="import">

<!--

`cross-fade` fades out elements in the outgoing page and fades in elements in the incoming page
during a page transition. By default, the transition applies to the `opacity` attribute. The
element to be animated should set the `cross-fade` attribute. You can also apply the `bg` attribute
to transition only the background color of the element and not its children.

You can globally configure the duration of the transition with the global variable
`CoreStyle.g.transitions.xfadeDuration`.

Example:

    <core-animated-pages transition="cross-fade">
        <section>
            <div id="div1" cross-fade bg>
                <div id="div2"></div>
            </div>
          <div id="div3" cross-fade></div>
        </section>
        <section>
            <div id="div4" cross-fade></div>
        </section>
    </core-animated-pages>

In the above example, when the page switches from 0 to 1, `#div3` fades out and `#div4`
fades in via an opacity transition. The background color for `#div1` fades out and `#div3`
remains visible.

`cross-fade-self` and `cross-fade-bg-self` apply the transition to all container elements:

    <core-animated-pages transition="cross-fade-self">
        <section id="page0">
            Page 1
        </section>
        <section id="page1">
            Page 2
        </section>
    </core-animated-pages>

In the above example, the transition will apply to `#page0` and `#page1`.

@group Pages Transition Elements
@class cross-fade
@extends core-pages-transition
@status beta
-->

<polymer-element name="cross-fade" extends="core-pages-transition">
<script>
(function() {

Polymer({

  publish: {

    bg: false

  },

  selector: '[cross-fade]',

  prefix: 'xfade',

  srcEffectForNode: function(node) {
    var effect = [
      {'opacity': 1},
      {'opacity': 0}
    ];

    if (this.bg || node.hasAttribute('bg')) {
      effect = [
        {'background-color': getComputedStyle(node).backgroundColor},
        {'background-color': 'rgba(0,0,0,0)'}
      ];
    }

    return effect;
  },

  dstEffectForNode: function(node) {
    var effect = [
      {'opacity': 0},
      {'opacity': 1}
    ];

  if (this.bg || node.hasAttribute('bg')) {
      effect = [
        {'background-color': 'rgba(0,0,0,0)'},
        {'background-color': getComputedStyle(node).backgroundColor}
      ];
    }

    return effect;
  },

});

}());
</script>
</polymer-element>

<cross-fade id="cross-fade"></cross-fade>
<cross-fade id="cross-fade-self" self></cross-fade>
<cross-fade id="cross-fade-bg-self" self bg></cross-fade>